import{r as e,R as t,a as o}from"./vendor.3da7a605.js";const r=29,l=29;function n(){const o=e.exports.useRef(null),n=e.exports.useRef((()=>{const e=[];for(let t=0;t<28;t++){const t=[];for(let e=0;e<28;e++)t.push(null);e.push(t)}return e})()),a=e.exports.useRef({x:0,y:0,lastX:0,lastY:0}),c=e.exports.useCallback(((e,t,o,a)=>{if(t>=l||o>=r)return;const s=n.current;let d,i,u,h;o+1<28&&(u={row:t,col:o+1,direction:"right"}),t+1<28&&(h={row:t+1,col:o,direction:"bottom"}),o-1>=0&&(d={row:t,col:o-1,direction:"left"}),t-1>=0&&(i={row:t-1,col:o,direction:"top"});let v=new Set;if(!s[t][o]){switch(a){case"left":v.add("right");break;case"right":v.add("left");break;case"top":v.add("bottom");break;case"bottom":v.add("top")}s[t][o]={x:20*(o+1),y:20*(t+1),leadTo:v}}const f=[d,i,u,h].filter((e=>{if(e){const{row:t,col:o}=e;return!s[t][o]}return!1}));if(!(null==f?void 0:f.length))return;const y=s[t][o],x=Math.floor(Math.random()*f.length),k=f.splice(x,1)[0],b=null==k?void 0:k.direction,m=null==k?void 0:k.row,g=null==k?void 0:k.col;switch(b){case"left":y.leadTo.add("left"),e.clearRect(y.x-1,y.y+1,2,20);break;case"right":y.leadTo.add("right"),e.clearRect(y.x+20-1,y.y+1,2,20);break;case"top":y.leadTo.add("top"),e.clearRect(y.x+1,y.y-1,20,2);break;case"bottom":y.leadTo.add("bottom"),e.clearRect(y.x+1,y.y+20-1,20,2)}c(e,m,g,b),f.forEach((t=>{c(e,m,g,0)}))}),[]);return e.exports.useEffect((()=>{const e=null==o?void 0:o.current,t=o=>{var r,l,c,s;const d=a.current,i=null==e?void 0:e.getContext("2d"),u=n.current;if(i){let e;const n=u[d.y][d.x];switch(i.clearRect(n.x+2,n.y+2,15,15),null==o?void 0:o.key){case"ArrowLeft":(null==(r=null==n?void 0:n.leadTo)?void 0:r.has("left"))&&(e=d.x-1,e<0&&(e=0),d.x=e);break;case"ArrowUp":(null==(l=null==n?void 0:n.leadTo)?void 0:l.has("top"))&&(e=d.y-1,e<0&&(e=0),d.y=e);break;case"ArrowRight":(null==(c=null==n?void 0:n.leadTo)?void 0:c.has("right"))&&(e=d.x+1,e>27&&(e=27),d.x=e);break;case"ArrowDown":(null==(s=null==n?void 0:n.leadTo)?void 0:s.has("bottom"))&&(e=d.y+1,e>27&&(e=27),d.y=e)}const{x:a,y:h}=d;i.beginPath(),i.strokeStyle="red",i.arc(u[h][a].x+10,u[h][a].y+10,5,0,2*Math.PI),i.closePath(),i.stroke(),27===a&&27===h&&(alert("到达终点"),document.removeEventListener("keydown",t))}};if(e){const o=null==e?void 0:e.getContext("2d");document.addEventListener("keydown",t),o&&((e=>{const t=20,o=580;e.beginPath(),e.lineWidth=1,e.moveTo(t,t),e.lineTo(o,t),e.lineTo(o,o),e.lineTo(t,o),e.lineTo(t,t),e.stroke();for(let l=2;l<r;l++)e.beginPath(),e.moveTo(l*t,t),e.lineTo(l*t,o),e.stroke(),e.beginPath(),e.moveTo(t,l*t),e.lineTo(o,l*t),e.stroke()})(o),c(o,0,0,0),(e=>{const{x:t,y:o}=a.current,r=n.current;e.beginPath(),e.strokeStyle="red",e.arc(r[o][t].x+10,r[o][t].y+10,5,0,2*Math.PI),e.closePath(),e.stroke(),e.beginPath(),e.strokeStyle="green",e.rect(r[27][27].x+4,r[27][27].y+4,12,12),e.closePath(),e.stroke()})(o))}return()=>{document.removeEventListener("keydown",t)}}),[]),t.createElement("canvas",{ref:o,width:600,height:600},"您的浏览器不支持canvas.")}o.render(t.createElement(t.StrictMode,null,t.createElement(n,null)),document.getElementById("root"));
